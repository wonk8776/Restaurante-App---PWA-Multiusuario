<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Familia González — Acceso</title>
    <link rel="icon" type="image/png" href="icons/icon-192.png">
    <link rel="apple-touch-icon" href="icons/icon-192.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#0F2D5E">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Familia González">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=DM+Serif+Display:ital@0;1&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="estilos.css">

    <style>
        :root {
            --color-bg: #F4F6FB;
            --color-card: #FFFFFF;
            --color-card-alt: #F0F4FF;
            --color-sidebar: #0F2D5E;
            --color-sidebar-active: #1565C0;
            --color-sidebar-text: #FFFFFF;
            --color-sidebar-text-muted: rgba(255,255,255,0.65);
            --color-primary: #1A56DB;
            --color-primary-light: #E3EEFF;
            --color-primary-hover: #1447B8;
            --color-accent: #1976D2;
            --color-green: #2E7D32;
            --color-green-light: #E8F5E9;
            --color-green-action: #388E3C;
            --color-green-action-hover: #2E7D32;
            --color-red: #C62828;
            --color-red-light: #FFEBEE;
            --color-warning: #F57F17;
            --color-warning-light: #FFF8E1;
            --color-text: #1A2744;
            --color-text-muted: #546E7A;
            --color-text-dim: #90A4AE;
            --color-border: #D6E0F0;
            --color-border-focus: #1565C0;
            --shadow-xs: 0 1px 3px rgba(26,58,107,0.08);
            --shadow-sm: 0 2px 8px rgba(26,58,107,0.10);
            --shadow-md: 0 4px 16px rgba(26,58,107,0.12);
            --shadow-lg: 0 8px 32px rgba(26,58,107,0.16);
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-pill: 999px;
            --font-heading: 'DM Serif Display', serif;
            --font-body: 'Inter', sans-serif;
            --color-error: var(--color-red);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        ::-webkit-scrollbar {
            width: 6px;
        }
        ::-webkit-scrollbar-track {
            background: var(--color-bg);
        }
        ::-webkit-scrollbar-thumb {
            background: var(--color-border);
            border-radius: var(--radius-pill);
        }
        ::-webkit-scrollbar-thumb:hover {
            background: var(--color-primary);
        }

        body {
            font-family: var(--font-body);
            background: linear-gradient(135deg, #1A3A6B 0%, #1565C0 40%, #2E7D32 100%);
            color: var(--color-text);
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
            position: relative;
        }

        .login-container {
            background: #FFFFFF;
            padding: 2.5rem;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
            width: 100%;
            max-width: 400px;
            text-align: center;
            border: none;
            position: relative;
            z-index: 1;
        }
        .login-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            border-radius: var(--radius-lg) var(--radius-lg) 0 0;
            background: linear-gradient(90deg, var(--color-sidebar) 0%, var(--color-primary) 50%, var(--color-green-action) 100%);
        }

        .logo {
            font-family: var(--font-heading);
            font-size: 1.8rem;
            color: var(--color-primary);
            margin-bottom: 0;
            letter-spacing: 1px;
        }

        .login-container .logo::after {
            content: '';
            display: block;
            width: 60px;
            margin: 0.75rem auto 1.5rem;
            border-bottom: 2px solid var(--color-border);
        }

        .subtitle {
            color: var(--color-text-muted);
            font-size: 0.9rem;
            margin-bottom: 2rem;
            font-weight: 300;
        }

        .login-container .form-group label {
            color: var(--color-text);
            font-weight: 600;
            font-size: 0.82rem;
            letter-spacing: 0.3px;
        }

        .form-group {
            margin-bottom: 1.5rem;
            text-align: left;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            font-size: 0.82rem;
            color: var(--color-text);
            font-weight: 600;
            letter-spacing: 0.3px;
        }

        input {
            width: 100%;
            padding: 12px;
            background: #F4F6FB;
            border: 1.5px solid var(--color-border);
            border-radius: var(--radius-sm);
            color: var(--color-text);
            font-size: 1rem;
            transition: border-color 0.3s, box-shadow 0.3s;
        }

        input:focus {
            outline: none;
            border-color: var(--color-border-focus);
            box-shadow: 0 0 0 3px rgba(21,101,192,0.12);
        }

        input::placeholder {
            color: var(--color-text-dim);
        }

        button {
            width: 100%;
            padding: 14px;
            background: var(--color-primary);
            color: #FFFFFF;
            border: none;
            border-radius: var(--radius-sm);
            font-size: 0.95rem;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.1s, box-shadow 0.2s;
            font-family: var(--font-body);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 1rem;
            box-shadow: var(--shadow-md);
        }

        button:hover {
            background: var(--color-primary-hover);
            box-shadow: var(--shadow-lg);
            transform: translateY(-1px);
        }

        button:active {
            opacity: 0.7;
            transform: scale(0.98);
        }

        .error-message {
            color: var(--color-red);
            font-size: 0.9rem;
            margin-top: 1rem;
            min-height: 1.25rem;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .error-message.visible {
            opacity: 1;
        }

        /* Loading spinner */
        .spinner {
            display: none;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: #FFFFFF;
            animation: spin 1s ease-in-out infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        button.loading .button-text {
            display: none;
        }

        button.loading .spinner {
            display: block;
        }
    </style>
</head>

<body>

    <div class="login-container">
        <h1 class="logo">
            <svg viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg" width="48" height="48" style="display:block;margin:0 auto 0.5rem;">
                <ellipse cx="20" cy="26" rx="14" ry="10" fill="#8B0000"/>
                <rect x="5" y="17" width="30" height="5" rx="2.5" fill="#6B0000"/>
                <ellipse cx="20" cy="18" rx="14" ry="5" fill="#A00000"/>
                <rect x="17" y="12" width="6" height="6" rx="3" fill="#5D4037"/>
                <path d="M13,11 C12,9 14,7 13,4" fill="none" stroke="#E0E0E0" stroke-width="1.5" stroke-linecap="round"/>
                <path d="M20,11 C19,9 21,7 20,4" fill="none" stroke="#E0E0E0" stroke-width="1.5" stroke-linecap="round"/>
                <path d="M27,11 C26,9 28,7 27,4" fill="none" stroke="#E0E0E0" stroke-width="1.5" stroke-linecap="round"/>
                <path d="M6,22 C3,22 3,28 6,28" fill="none" stroke="#6B0000" stroke-width="2.5" stroke-linecap="round"/>
                <path d="M34,22 C37,22 37,28 34,28" fill="none" stroke="#6B0000" stroke-width="2.5" stroke-linecap="round"/>
            </svg>
            Familia González
        </h1>
        <p class="subtitle">Sistema de gestión · Barbacoa y más</p>

        <form id="loginForm">
            <div class="form-group">
                <label for="email">CORREO ELECTRÓNICO</label>
                <input type="email" id="email" required autocomplete="email" placeholder="nombre@restaurante.com">
            </div>

            <div class="form-group">
                <label for="password">CONTRASEÑA</label>
                <input type="password" id="password" required autocomplete="current-password" placeholder="••••••••">
            </div>

            <button type="submit" id="loginBtn">
                <span class="button-text">INGRESAR</span>
                <div class="spinner"></div>
            </button>

            <button
                type="button"
                id="btnInstall"
                style="display:none; margin-top: 12px; width:100%; background: var(--color-primary); color:#fff; border:none; padding:12px; border-radius:10px; font-weight:700; cursor:pointer;"
            >Instalar app</button>

            <div id="errorMessage" class="error-message"></div>
        </form>
    </div>

    <!-- Firebase SDKs (Compat) -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>

    <!-- App Configuration -->
    <script src="firebase-config.js"></script>
    <script src="auth.js"></script>
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/sw.js').catch(function (err) { console.warn('SW no registrado:', err); });
        }

        (function () {
            var deferredPrompt = null;
            var btnInstall = document.getElementById('btnInstall');
            if (!btnInstall) return;

            window.addEventListener('beforeinstallprompt', function (e) {
                e.preventDefault();
                deferredPrompt = e;
                btnInstall.style.display = 'block';
            });

            btnInstall.addEventListener('click', function () {
                if (!deferredPrompt) return;
                btnInstall.disabled = true;
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then(function () {
                    deferredPrompt = null;
                    btnInstall.style.display = 'none';
                    btnInstall.disabled = false;
                }).catch(function () {
                    btnInstall.disabled = false;
                });
            });

            window.addEventListener('appinstalled', function () {
                deferredPrompt = null;
                btnInstall.style.display = 'none';
            });
        })();
    </script>
</body>

</html>